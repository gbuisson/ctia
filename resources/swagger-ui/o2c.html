<script>
 var qp = null;
 if(window.location.hash && window.location.hash !== "#_=_") {
     qp = location.hash.substring(1);
 }
 else {
     qp = location.search.substring(1);
 }
 qp = qp ? JSON.parse('{"' + qp.replace(/&/g, '","').replace(/=/g,'":"') + '"}',
                      function(key, value) {
                          return key===""?value:decodeURIComponent(value) }
 ):{}

 // uncomment here to debug
 // console.log(JSON.stringify(qp));

 if (window.opener.swaggerUiAuth.tokenUrl) {
     window.opener.processOAuthCode(qp);
     //https://github.com/swagger-api/swagger-ui/blob/52f3b6d50ec727a8f4d8ddd06388a7edb5d4f97e/dist/lib/swagger-oauth.js#L251
     setTimeout(window.close, 5000);
 }
 else {
     window.opener.onOAuthComplete(qp);
     window.close();
 }
</script>
